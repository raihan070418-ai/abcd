<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Catatan Kas Bendahara</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, sans-serif;
      background: linear-gradient(135deg, #ffffff, #e6f0ff, #cce0ff);
      margin: 0; padding: 0;
      text-align: center;
      color: #222;
    }
    header {
      background: #004aad;
      color: white;
      padding: 15px 0;
      font-size: 22px;
      font-weight: bold;
    }
    button {
      margin: 5px;
      padding: 8px 15px;
      border: none;
      border-radius: 8px;
      background: #007bff;
      color: white;
      cursor: pointer;
    }
    button:hover { background: #0056b3; }
    table {
      margin: 20px auto;
      border-collapse: collapse;
      width: 95%;
      background: white;
      box-shadow: 0 0 8px rgba(0,0,0,0.1);
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th { background: #f0f8ff; }
  </style>
</head>
<body>

  <header>Catatan Kas Bendahara</header>

  <div style="margin-top:10px;">
    <button id="switchPutra">Data PUTRA</button>
    <button id="switchPutri">Data PUTRI</button>
    <button id="toggleMode">Masuk Admin</button>
    <button id="gantiPass" style="display:none;">Ganti Password</button>
  </div>

  <table>
    <thead>
      <tr>
        <th>Nama</th>
        <th>Pemasukan</th>
        <th>Pengeluaran</th>
        <th>Saldo</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody id="dataTabel"></tbody>
  </table>

  <script>
    // === Variabel utama ===
    let currentGender = "putra";
    let isLocked = true;
    let data = JSON.parse(localStorage.getItem("kasData")) || { putra: [], putri: [] };

    // === Password dari localStorage (biar bisa diubah & tersimpan) ===
    let passwordPutra = localStorage.getItem("passPutra") || "1234";
    let passwordPutri = localStorage.getItem("passPutri") || "5678";

    // === Simpan data ===
    function saveData() {
      localStorage.setItem("kasData", JSON.stringify(data));
    }

    // === Render tabel ===
    function renderTable() {
      const tbody = document.getElementById("dataTabel");
      tbody.innerHTML = "";
      data[currentGender].forEach((item, i) => {
        let tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${item.nama}</td>
          <td>${item.masuk}</td>
          <td>${item.keluar}</td>
          <td>${item.masuk - item.keluar}</td>
          <td>${!isLocked ? `<button onclick="hapus(${i})">Hapus</button>` : "-"}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    // === Hapus data ===
    function hapus(index) {
      if (confirm("Yakin mau hapus data ini?")) {
        data[currentGender].splice(index, 1);
        saveData();
        renderTable();
      }
    }

    // === Tambah data baru ===
    function tambahData() {
      const nama = prompt("Nama:");
      const masuk = Number(prompt("Pemasukan:"));
      const keluar = Number(prompt("Pengeluaran:"));
      if (!nama) return alert("Nama wajib diisi!");
      data[currentGender].push({ nama, masuk, keluar });
      saveData();
      renderTable();
    }

    // === Ganti bagian (Putra/Putri) ===
    document.getElementById("switchPutra").onclick = () => {
      currentGender = "putra";
      isLocked = true;
      document.getElementById("toggleMode").innerText = "Masuk Admin";
      document.getElementById("gantiPass").style.display = "none";
      renderTable();
    };
    document.getElementById("switchPutri").onclick = () => {
      currentGender = "putri";
      isLocked = true;
      document.getElementById("toggleMode").innerText = "Masuk Admin";
      document.getElementById("gantiPass").style.display = "none";
      renderTable();
    };

    // === Masuk / Keluar mode Admin ===
    document.getElementById("toggleMode").addEventListener("click", () => {
      if (isLocked) {
        let pass = prompt("Masukkan sandi Admin " + currentGender.toUpperCase());
        if (currentGender === "putra" && pass === passwordPutra) {
          isLocked = false;
        } else if (currentGender === "putri" && pass === passwordPutri) {
          isLocked = false;
        } else {
          alert("Sandi salah untuk admin " + currentGender.toUpperCase() + "!");
          return;
        }

        // sukses login
        document.getElementById("toggleMode").innerText = "Keluar Admin";
        document.getElementById("gantiPass").style.display = "inline-block";
        renderTable();
      } else {
        // logout
        isLocked = true;
        document.getElementById("toggleMode").innerText = "Masuk Admin";
        document.getElementById("gantiPass").style.display = "none";
        renderTable();
      }
    });

    // === Ganti password ===
    document.getElementById("gantiPass").addEventListener("click", () => {
      if (isLocked) return;
      const passLama = prompt("Masukkan password lama:");
      const passBaru = prompt("Masukkan password baru:");

      if (!passBaru || passBaru.trim() === "") return alert("Password baru tidak boleh kosong!");

      if (currentGender === "putra") {
        if (passLama === passwordPutra) {
          passwordPutra = passBaru;
          localStorage.setItem("passPutra", passBaru);
          alert("Password PUTRA berhasil diubah!");
        } else alert("Password lama salah!");
      } else {
        if (passLama === passwordPutri) {
          passwordPutri = passBaru;
          localStorage.setItem("passPutri", passBaru);
          alert("Password PUTRI berhasil diubah!");
        } else alert("Password lama salah!");
      }
    });

    // === Klik 2x header buat tambah data cepat (hanya admin) ===
    document.querySelector("header").ondblclick = () => {
      if (!isLocked) tambahData();
      else alert("Masuk admin dulu!");
    };

    renderTable();
  </script>
</body>
</html>
